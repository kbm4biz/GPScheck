<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>حاسبة رسوم التدريب</title>
    <style>
        /* نفس التنسيق السابق */
    </style>
    <!-- إضافة مكتبات JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // بيانات الخط المحول إلى Base64
        var amiriFont = "data:font/truetype;charset=utf-8;base64,AAEAAAASAQAABA..."; // استبدل هذه البيانات ببيانات الخط الفعلية

        function addArabicFont(jsPDFAPI) {
            jsPDFAPI.addFileToVFS("Amiri-Regular.ttf", amiriFont);
            jsPDFAPI.addFont("Amiri-Regular.ttf", "Amiri", "normal");
        }

        async function generatePDF(totalFee, timestamp, details) {
            const { jsPDF } = window.jspdf;

            // إضافة الخط العربي
            addArabicFont(jsPDF.API);

            // إنشاء مستند PDF جديد
            const doc = new jsPDF();

            // تعيين الخط العربي
            doc.setFont("Amiri");
            doc.setFontSize(20);
            doc.setR2L(true);

            // إضافة العنوان
            doc.text("تفاصيل رسوم التدريب", 105, 20, { align: "center" });

            // إضافة التفاصيل
            doc.setFontSize(14);
            let yPosition = 40;
            for (const [key, value] of Object.entries(details)) {
                doc.text(`${key}: ${value}`, 190, yPosition, { align: "right" });
                yPosition += 10;
            }

            // إضافة إجمالي الرسوم
            doc.setFontSize(16);
            doc.text(`إجمالي الرسوم: ${totalFee} ريال سعودي`, 190, yPosition + 10, { align: "right" });

            // إضافة الطابع الزمني
            doc.setFontSize(12);
            doc.text(`الوقت: ${timestamp}`, 190, yPosition + 20, { align: "right" });

            // إضافة العلامة المائية
            doc.setFontSize(10);
            doc.setTextColor(150);
            doc.text("تطوير khaled1", 105, 290, { align: "center" });

            // حفظ ملف PDF في Blob URL
            const pdfBlob = doc.output('blob');
            const pdfUrl = URL.createObjectURL(pdfBlob);

            return pdfUrl;
        }

        // بقية الكود (دالة calculateFee وغيرها) تبقى كما هي
    </script>
</head>
<body>
    <!-- بقية الكود تبقى كما هي -->
</body>
</html>